  name: Criar pull request para aggr
  on:
    push:
      branches:
        - espelho-openapi

  jobs:
    create_pull_request:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v3
        - name: Creating pull request to aggr
          env:
            GH_TOKEN: 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
          run: |
            git fetch --all
            features=$(git branch -r | grep -i "aggr" | sed -e "s/.*origin\///g; /merge/d" | tr "\n" " ")
            eval "featureArray=($features)"

            echo "Conteúdo de featureArray: ${featureArray[@]}"
            # create merge branches            
            for featureBranch in ${featureArray[@]}
            do
              echo $featureBranch

              gh pr create -B $featureBranch -H espelho-openapi --title 'Atualização espelho-openapi' --body ''
            done
